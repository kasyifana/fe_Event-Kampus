<div class="whitelist-page">
    <!-- HERO HEADER -->
    <div class="page-header">
        <div>
            <h1>Jadi Organisasi</h1>
            <p>Ajukan permohonan untuk menjadi penyelenggara event</p>
        </div>
    </div>

    <div class="page-content">
        <!-- LOADING -->
        <div class="alert alert-info" *ngIf="isLoading">
            Memuat data...
        </div>

        <!-- ERROR -->
        <div class="alert alert-error" *ngIf="!isLoading && errorMessage">
            {{ errorMessage }}
        </div>

        <!-- SUCCESS -->
        <div class="alert alert-success" *ngIf="!isLoading && successMessage">
            {{ successMessage }}
        </div>

        <!-- EXISTING REQUEST STATUS -->
        <div class="status-card" *ngIf="!isLoading && hasExistingRequest && existingRequest">
            <div class="status-header">
                <h3>Status Permohonan</h3>
                <span [class]="'status-badge ' + statusClass">{{ statusLabel }}</span>
            </div>

            <div class="status-body">
                <div class="info-row">
                    <span class="label">Nama Organisasi:</span>
                    <span class="value">{{ existingRequest.organization_name }}</span>
                </div>

                <div class="info-row">
                    <span class="label">Tanggal Pengajuan:</span>
                    <span class="value">{{ existingRequest.created_at | date: 'dd MMM yyyy, HH:mm' }}</span>
                </div>

                <div class="info-row" *ngIf="existingRequest.status !== 'pending'">
                    <span class="label">Tanggal Review:</span>
                    <span class="value">{{ existingRequest.reviewed_at | date: 'dd MMM yyyy, HH:mm' }}</span>
                </div>

                <div class="info-row" *ngIf="existingRequest.admin_notes">
                    <span class="label">Catatan Admin:</span>
                    <span class="value">{{ existingRequest.admin_notes }}</span>
                </div>
            </div>

            <div class="status-footer" *ngIf="existingRequest.status === 'pending'">
                <p class="info-text">‚è≥ Permohonan Anda sedang dalam proses review oleh admin.</p>
            </div>

            <div class="status-footer" *ngIf="existingRequest.status === 'approved'">
                <p class="info-text success">‚úÖ Selamat! Anda sekarang dapat membuat dan mengelola event sebagai
                    organisasi.</p>
            </div>

            <div class="status-footer" *ngIf="existingRequest.status === 'rejected'">
                <p class="info-text error">‚ùå Permohonan ditolak. Anda dapat mengajukan permohonan baru dengan
                    memperbaiki dokumen.</p>
            </div>
        </div>

        <!-- REQUEST FORM -->
        <div class="form-card" *ngIf="!isLoading && canSubmit">
            <h3>{{ hasExistingRequest ? 'Ajukan Permohonan Baru' : 'Form Permohonan' }}</h3>

            <form #requestForm="ngForm" (ngSubmit)="onSubmit()">
                <!-- Organization Name -->
                <div class="form-group">
                    <label for="orgName">Nama Organisasi <span class="required">*</span></label>
                    <input id="orgName" type="text" name="organizationName" [(ngModel)]="organizationName" required
                        placeholder="Contoh: Himpunan Mahasiswa Teknik Informatika" [disabled]="isLoading" />
                    <small class="hint">Masukkan nama resmi organisasi Anda</small>
                </div>

                <!-- Document Upload -->
                <div class="form-group">
                    <label>Dokumen Pendukung <span class="required">*</span></label>

                    <div class="upload-area">
                        <input #fileInput type="file" accept="application/pdf" (change)="onFileSelected($event)"
                            hidden />

                        <button type="button" class="upload-btn" (click)="fileInput.click()" [disabled]="isLoading">
                            <span class="icon">üìÑ</span>
                            <span>{{ selectedFile ? 'Ganti Dokumen' : 'Pilih Dokumen PDF' }}</span>
                        </button>

                        <div class="file-info" *ngIf="selectedFile">
                            <span class="file-icon">‚úì</span>
                            <span class="file-name">{{ selectedFile.name }}</span>
                            <span class="file-size">({{ (selectedFile.size / 1024 / 1024).toFixed(2) }} MB)</span>
                        </div>
                    </div>

                    <small class="hint">
                        Upload dokumen pendukung (Surat rekomendasi, SK organisasi, atau dokumen resmi lainnya).
                        Format: PDF, Max: 5MB
                    </small>
                </div>

                <!-- Submit Button -->
                <div class="form-actions">
                    <button type="submit" class="btn-primary"
                        [disabled]="requestForm.invalid || !selectedFile || isLoading">
                        {{ isLoading ? 'Mengirim...' : 'Kirim Permohonan' }}
                    </button>
                </div>
            </form>
        </div>

        <!-- INFO CARD -->
        <div class="info-card" *ngIf="!isLoading && !hasExistingRequest">
            <h4>‚ÑπÔ∏è Informasi Penting</h4>
            <ul>
                <li>Permohonan akan direview oleh admin dalam 1-3 hari kerja</li>
                <li>Pastikan dokumen pendukung yang diunggah valid dan jelas</li>
                <li>Setelah disetujui, Anda dapat membuat dan mengelola event</li>
                <li>Jika ditolak, Anda dapat mengajukan permohonan baru</li>
            </ul>
        </div>
    </div>
</div>