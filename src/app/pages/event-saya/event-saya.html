<!-- src/app/pages/event-saya/event-saya.html -->
<div class="event-page">
  <!-- HEADER -->
  <div class="page-header">
    <h1>Event Saya</h1>
    <p>Kelola semua event yang Anda ikuti</p>
  </div>

  <!-- LOADING & ERROR -->
  <p *ngIf="isLoading" class="info-text">Memuat event yang kamu ikuti...</p>
  <p *ngIf="!isLoading && errorMessage" class="info-text error">
    {{ errorMessage }}
  </p>

  <!-- KARTU STATISTIK -->
  <div
    class="stats-row"
    *ngIf="!isLoading && !errorMessage"
  >
    <div class="stat-card stat-upcoming">
      <div class="stat-icon">ğŸ“…</div>
      <div class="stat-text">
        <div class="stat-label">Event Mendatang</div>
        <div class="stat-value">{{ upcomingCount }}</div>
      </div>
    </div>

    <div class="stat-card stat-done">
      <div class="stat-icon">âœ”</div>
      <div class="stat-text">
        <div class="stat-label">Event Selesai</div>
        <div class="stat-value">{{ doneCount }}</div>
      </div>
    </div>
  </div>

  <!-- EVENT MENDATANG -->
  <div
    class="section-card"
    *ngIf="!isLoading && !errorMessage"
  >
    <div class="section-header">
      <h2>Event Mendatang</h2>
    </div>

    <div
      class="event-list"
      *ngIf="upcomingEvents.length > 0; else noUpcoming"
    >
      <div
        class="event-card"
        *ngFor="let e of upcomingEvents"
      >
        <div class="event-poster">
          <img
            [src]="e.posterUrl"
            [alt]="e.title"
            loading="lazy"
            (error)="onPosterError(e)"
          />
        </div>

        <div class="event-info">
          <div class="event-header">
            <div>
              <div class="event-title">{{ e.title }}</div>
              <div class="event-organizer">{{ e.organizer }}</div>
            </div>
            <div class="event-badge">
              {{ e.category }}
            </div>
          </div>

          <div class="event-meta">
            <div class="meta-item">
              <span class="meta-icon">ğŸ“…</span>
              <span class="meta-text">{{ e.date }}</span>
            </div>
            <div class="meta-item">
              <span class="meta-icon">ğŸ•’</span>
              <span class="meta-text">{{ e.time }}</span>
            </div>
            <div class="meta-item">
              <span class="meta-icon">ğŸ“</span>
              <span class="meta-text">{{ e.place }}</span>
            </div>
          </div>

          <div class="event-actions">
            <button
              type="button"
              class="btn-primary"
              (click)="onViewDetail(e)"
            >
              Lihat Detail
            </button>
            <button
              type="button"
              class="btn-danger"
              (click)="onCancel(e)"
            >
              Batalkan
            </button>
          </div>
        </div>
      </div>
    </div>

    <ng-template #noUpcoming>
      <p class="info-text">
        Belum ada event mendatang yang kamu ikuti.
      </p>
    </ng-template>
  </div>

  <!-- RIWAYAT EVENT -->
  <div
    class="section-card"
    *ngIf="!isLoading && !errorMessage"
  >
    <div class="section-header">
      <h2>Riwayat Event</h2>
    </div>

    <div
      class="event-list"
      *ngIf="historyEvents.length > 0; else noHistory"
    >
      <div
        class="event-card"
        *ngFor="let e of historyEvents"
      >
        <div class="event-poster">
          <img
            [src]="e.posterUrl"
            [alt]="e.title"
            loading="lazy"
            (error)="onPosterError(e)"
          />
        </div>

        <div class="event-info">
          <div class="event-header">
            <div>
              <div class="event-title">{{ e.title }}</div>
              <div class="event-organizer">{{ e.organizer }}</div>
            </div>
            <div class="event-badge badge-gray">
              {{ e.category }}
            </div>
          </div>

          <div class="event-meta">
            <div class="meta-item">
              <span class="meta-icon">ğŸ“…</span>
              <span class="meta-text">{{ e.date }}</span>
            </div>
            <div class="meta-item">
              <span class="meta-icon">ğŸ•’</span>
              <span class="meta-text">{{ e.time }}</span>
            </div>
            <div class="meta-item">
              <span class="meta-icon">ğŸ“</span>
              <span class="meta-text">{{ e.place }}</span>
            </div>
          </div>

          <div class="event-actions">
            <button
              type="button"
              class="btn-primary"
              (click)="onOpenCertificate(e)"
            >
              Link Sertifikasi
            </button>
          </div>
        </div>
      </div>
    </div>

    <ng-template #noHistory>
      <p class="info-text">Belum ada riwayat event.</p>
    </ng-template>
  </div>
</div>
